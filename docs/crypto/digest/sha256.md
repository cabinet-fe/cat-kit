# SHA256

SHA256 (Secure Hash Algorithm 256-bit) æ˜¯ SHA-2 å®¶æ—ä¸­çš„ä¸€å‘˜ï¼Œæ˜¯ä¸€ç§å®‰å…¨çš„åŠ å¯†å“ˆå¸Œå‡½æ•°ã€‚

## ç‰¹æ€§

- âœ… 256 ä½ï¼ˆ64 å­—ç¬¦ï¼‰å“ˆå¸Œå€¼
- âœ… å¯†ç å­¦å®‰å…¨
- âœ… æŠ—ç¢°æ’æ€§å¼º
- âœ… é€‚ç”¨äºå¯†ç å­˜å‚¨å’Œæ•°å­—ç­¾å
- âœ… çº¯ JavaScript å®ç°

::: tip æ¨èä½¿ç”¨
SHA256 æ˜¯å½“å‰æ¨èçš„å“ˆå¸Œç®—æ³•ï¼Œé€‚åˆç”¨äºå¯†ç å­˜å‚¨ã€æ•°æ®ç­¾åç­‰å®‰å…¨æ•æ„Ÿåœºæ™¯ã€‚
:::

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
bun add @cat-kit/crypto
```

### åŸºæœ¬ç”¨æ³•

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// è®¡ç®—å“ˆå¸Œ
const hash = sha256('Hello, World!')
console.log(hash)
// '03ba204e50d126e4674c005e04d82e84c21366780af1f43bd54a37816b6ab340'
```

## API å‚è€ƒ

### sha256

è®¡ç®—å­—ç¬¦ä¸²çš„ SHA256 å“ˆå¸Œå€¼ã€‚

#### ç±»å‹ç­¾å

```typescript
function sha256(message: string): string
```

#### å‚æ•°

| å‚æ•°    | ç±»å‹     | è¯´æ˜               |
| ------- | -------- | ------------------ |
| message | `string` | è¦è®¡ç®—å“ˆå¸Œçš„å­—ç¬¦ä¸² |

#### è¿”å›å€¼

è¿”å› 64 å­—ç¬¦çš„åå…­è¿›åˆ¶ SHA256 å“ˆå¸Œå€¼ã€‚

#### ç¤ºä¾‹

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// åŸºæœ¬ç”¨æ³•
console.log(sha256('hello'))
// '2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824'

// ä¸­æ–‡æ”¯æŒ
console.log(sha256('ä½ å¥½'))
// å¯¹åº”çš„ SHA256 å€¼

// ç©ºå­—ç¬¦ä¸²
console.log(sha256(''))
// 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'
```

## ä½¿ç”¨åœºæ™¯

### 1. å¯†ç å­˜å‚¨

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// å¯†ç åŠ ç›å“ˆå¸Œ
function hashPassword(password: string, userId: number): string {
  const salt = `user-${userId}-salt`
  return sha256(password + salt)
}

// éªŒè¯å¯†ç 
function verifyPassword(
  password: string,
  userId: number,
  hash: string
): boolean {
  return hashPassword(password, userId) === hash
}

// ä½¿ç”¨ç¤ºä¾‹
const userId = 1
const password = 'MySecurePassword123!'

// æ³¨å†Œæ—¶
const passwordHash = hashPassword(password, userId)
// å­˜å‚¨åˆ°æ•°æ®åº“: { userId, passwordHash }

// ç™»å½•æ—¶
const isValid = verifyPassword(password, userId, passwordHash)
console.log('å¯†ç æ­£ç¡®:', isValid)
```

### 2. æ•°æ®ç­¾å

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// ç”Ÿæˆç­¾å
function signData(data: object, secret: string): string {
  const json = JSON.stringify(data)
  return sha256(json + secret)
}

// éªŒè¯ç­¾å
function verifySignature(
  data: object,
  signature: string,
  secret: string
): boolean {
  return signData(data, secret) === signature
}

// ä½¿ç”¨ç¤ºä¾‹
const apiData = {
  userId: 123,
  action: 'transfer',
  amount: 100,
  timestamp: Date.now()
}

const secret = 'my-api-secret'
const signature = signData(apiData, secret)

// å‘é€æ•°æ®
const payload = {
  ...apiData,
  signature
}

// æ¥æ”¶æ–¹éªŒè¯
const isValid = verifySignature(apiData, signature, secret)
```

### 3. æ–‡ä»¶å®Œæ•´æ€§æ ¡éªŒ

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

async function calculateFileHash(file: File): Promise<string> {
  const content = await file.text()
  return sha256(content)
}

async function verifyFileIntegrity(
  file: File,
  expectedHash: string
): Promise<boolean> {
  const actualHash = await calculateFileHash(file)
  return actualHash === expectedHash
}

// ä½¿ç”¨ç¤ºä¾‹
const file = new File(['content'], 'data.txt')
const hash = await calculateFileHash(file)
console.log('æ–‡ä»¶å“ˆå¸Œ:', hash)

// éªŒè¯
const isValid = await verifyFileIntegrity(file, hash)
console.log('æ–‡ä»¶å®Œæ•´:', isValid)
```

### 4. API è¯·æ±‚ç­¾å

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

interface RequestParams {
  method: string
  path: string
  body?: any
  timestamp: number
}

function signRequest(params: RequestParams, apiSecret: string): string {
  const { method, path, body, timestamp } = params

  // æ„å»ºç­¾åå­—ç¬¦ä¸²
  const signString = [
    method.toUpperCase(),
    path,
    body ? JSON.stringify(body) : '',
    timestamp.toString(),
    apiSecret
  ].join('\n')

  return sha256(signString)
}

// ä½¿ç”¨ç¤ºä¾‹
const params = {
  method: 'POST',
  path: '/api/users',
  body: { name: 'å¼ ä¸‰' },
  timestamp: Date.now()
}

const signature = signRequest(params, 'secret-key')

// å‘é€è¯·æ±‚
fetch('/api/users', {
  method: 'POST',
  headers: {
    'X-Signature': signature,
    'X-Timestamp': params.timestamp.toString()
  },
  body: JSON.stringify(params.body)
})
```

### 5. åŒºå—é“¾åº”ç”¨

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

interface Block {
  index: number
  timestamp: number
  data: any
  previousHash: string
  hash?: string
}

function calculateBlockHash(block: Block): string {
  const { index, timestamp, data, previousHash } = block
  const content = `${index}${timestamp}${JSON.stringify(data)}${previousHash}`
  return sha256(content)
}

function createBlock(index: number, data: any, previousHash: string): Block {
  const block: Block = {
    index,
    timestamp: Date.now(),
    data,
    previousHash
  }

  block.hash = calculateBlockHash(block)
  return block
}

// ä½¿ç”¨ç¤ºä¾‹
const genesisBlock = createBlock(0, 'Genesis Block', '0')
const block1 = createBlock(1, { amount: 100 }, genesisBlock.hash!)
```

## å®‰å…¨æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ç›å€¼

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// âœ… æ¨èï¼šä½¿ç”¨ç›å€¼
function hashWithSalt(data: string, salt: string): string {
  return sha256(data + salt)
}

// âŒ ä¸æ¨èï¼šä¸ä½¿ç”¨ç›å€¼
function hashWithoutSalt(data: string): string {
  return sha256(data)
}
```

### 2. å¤šæ¬¡å“ˆå¸Œ

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// å¢å¼ºå®‰å…¨æ€§ï¼šå¤šæ¬¡å“ˆå¸Œ
function multiHash(data: string, iterations: number = 1000): string {
  let hash = data
  for (let i = 0; i < iterations; i++) {
    hash = sha256(hash)
  }
  return hash
}

// ç”¨äºå¯†ç å­˜å‚¨
const passwordHash = multiHash('password123', 10000)
```

### 3. ç»„åˆä½¿ç”¨

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'

// å¯†ç  + ç›å€¼ + å¤šæ¬¡å“ˆå¸Œ
function secureHash(
  password: string,
  salt: string,
  iterations: number = 1000
): string {
  let hash = password + salt
  for (let i = 0; i < iterations; i++) {
    hash = sha256(hash)
  }
  return hash
}
```

## SHA256 vs MD5

| ç‰¹æ€§     | SHA256           | MD5              |
| -------- | ---------------- | ---------------- |
| å“ˆå¸Œé•¿åº¦ | 256 ä½ (64 å­—ç¬¦) | 128 ä½ (32 å­—ç¬¦) |
| å®‰å…¨æ€§   | âœ… å®‰å…¨          | âš ï¸ ä¸å®‰å…¨        |
| ç¢°æ’æŠ—æ€§ | âœ… å¼º            | âŒ å¼±            |
| é€Ÿåº¦     | ğŸ¢ è¾ƒæ…¢          | âš¡ å¿«            |
| é€‚ç”¨åœºæ™¯ | å¯†ç ã€ç­¾å       | æ–‡ä»¶æ ¡éªŒã€å»é‡   |
| æ¨èä½¿ç”¨ | âœ… æ˜¯            | âš ï¸ ä»…éå®‰å…¨åœºæ™¯  |

## æ€§èƒ½è€ƒè™‘

SHA256 æ¯” MD5 æ…¢ï¼Œä½†æ›´å®‰å…¨ï¼š

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'
import { md5 } from '@cat-kit/crypto/digest/md5'

const data = 'hello world'

// SHA256
console.time('SHA256')
for (let i = 0; i < 10000; i++) {
  sha256(data)
}
console.timeEnd('SHA256')

// MD5
console.time('MD5')
for (let i = 0; i < 10000; i++) {
  md5(data)
}
console.timeEnd('MD5')
```

### ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜å“ˆå¸Œå€¼**ï¼šé¿å…é‡å¤è®¡ç®—
2. **å¼‚æ­¥å¤„ç†**ï¼šå¤§æ•°æ®é‡æ—¶ä½¿ç”¨ Worker
3. **æ‰¹é‡è®¡ç®—**ï¼šä½¿ç”¨ `parallel` å¹¶è¡Œå¤„ç†

```typescript
import { sha256 } from '@cat-kit/crypto/digest/sha256'
import { parallel } from '@cat-kit/core'

// å¹¶è¡Œè®¡ç®—å¤šä¸ªå“ˆå¸Œ
async function hashMany(items: string[]) {
  return await parallel(items, async item => sha256(item), { concurrency: 4 })
}
```

## å¸¸è§å“ˆå¸Œå€¼

| å­—ç¬¦ä¸²     | SHA256                                                             |
| ---------- | ------------------------------------------------------------------ |
| (ç©ºå­—ç¬¦ä¸²) | `e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855` |
| `a`        | `ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb` |
| `hello`    | `2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824` |
| `password` | `5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8` |

## ç›¸å…³ API

- [MD5](/crypto/digest/md5) - å¿«é€Ÿå“ˆå¸Œï¼ˆéå®‰å…¨ï¼‰
- [AES åŠ å¯†](/crypto/symmetric/aes) - å¯¹ç§°åŠ å¯†
- [NanoID](/crypto/key-gen/nanoid) - å”¯ä¸€ ID ç”Ÿæˆ
